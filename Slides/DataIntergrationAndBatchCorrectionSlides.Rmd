---
title: "Data Integration and Batch Correction"
author: "Abbi Edwards"
date: '7th June 2021'
output:
  ioslides_presentation:
    widescreen: true
    smaller: true
    logo: ../Images/CRUK_CC_whiteBgd.jpg
    css: css/stylesheet.css
---

```{r include=FALSE}
library(tidyr)
library(dplyr)

```

## Workflow

<div style="line-height: 50%;"><br></div>

<img src="../Images/workflow.svg" class="centerimg" style="width: 60%; margin-top: 60px;">

## Why do we need to think about data intergration?

Text

## Formatting our data

Text

## Cellranger aggr

<img src="../Images/10X_cellranger_aggr.png" class="centerimg" style="width: 60%; margin-top: 60px;">

## Checking for batch effects

## Batch Corrections

## Linear Models

## SCTransform

## MNN correct

## FastMNN

1. Perform a multi-sample PCA on the (cosine-)normalized expression values to reduce dimensionality.
2. Identify MNN pairs in the low-dimensional space between a reference batch and a target batch.
3. Remove variation along the average batch vector in both reference and target batches.
4. Correct the cells in the target batch towards the reference, using locally weighted correction vectors.
5. Merge the corrected target batch with the reference, and repeat with the next target batch.

## Harmony

## Checking our correction has worked

## Checking our correction hasn't over worked

## Using the corrected values



